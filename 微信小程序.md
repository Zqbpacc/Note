# 小程序

**概念：**微信是2011年1月21日推出的一个为智能终端提出的一个即时通讯服务的免费应用程序。张小龙带领的腾讯广州研发中心产品团队打造。

2016年9月21日小程序开始内测，2017年1月9日正式上线。



## 小程序组件化开发工具

#### mpvue



#### WePY



| 文件                                                         | 必需 | 作用                           |
| :----------------------------------------------------------- | :--- | :----------------------------- |
| pages                                                        |      | 页面资源（第一个默认是首页）   |
| [app.js](https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/app.html) | 是   | 小程序逻辑                     |
| [app.json](https://developers.weixin.qq.com/miniprogram/dev/framework/config.html) | 是   | 小程序公共配置（存储交换数据） |
| [app.wxss](https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxss.html) | 否   | 小程序公共样式表               |



## 项目上线流程

* 本地开发-
* 开发版
* 体验版
* 提交审核
* 线上版



ES5 支持元素最后面有一个伪逗号（多余的一个逗号），



即时通讯工具IM：socket.io（Web.socket）、云信、环信；

文件



## 逻辑层

页面注册page

小程序注册App



模块化： commonjs

页面路由



## 视图层

模板引擎： handlebars、art-template、ejs



wx:for="{{表达式}}"   {{item}} -- {{index}}

改名wx:for-item="i"



wx:if     hideen  类似Vue里面的v-if 和 v-show

模板使用



地图使用：

```htnl
<map>标签

wx.getLocaltion 需要用户授权 可以设置 type  
```

点击事件bindTap / bindChange



## 利用<map>标签获取位置

注意：  **任何data数据修改都要调用 `setData` 方法**



**marker标记**

```js
# marker  标记点用于在地图上显示标记的位置

markers: [{
      iconPath: "/resources/others.png",
      id: 0,
      latitude: 23.099994,
      longitude: 113.324520,
      width: 50,
      height: 50
    }]
```

**获取当前地址**

```js
# wx.getLocaltion  获取当前地址
用户授权：可以设置type : “gcj02坐标系”或者“wgs84（默认）”

# 注意点：
1. wx.authorize({scope: "scope.userInfo"})，不会弹出授权窗口，请使用 <button open-type="getUserInfo"/>
2. 需要授权 scope.userLocation 时必须配置地理位置用途说明。
3. map 组件使用的经纬度是火星坐标系，调用 wx.getLocation 接口需要指定 type 为 gcj02


wx.getLocaltion 需要在app.json中申明permission字段。
{
  "pages": ["pages/index/index"],
  "permission": {
    "scope.userLocation": {
      "desc": "你的位置信息将用于小程序位置接口的效果展示"
    }
  }
}
```

**点击跳转页面**

```js
# 回到定位点
wx.navigateTo(Object object)  url=""
保留当前页面，跳转到应用内的某个页面。但是不能跳到 tabbar 页面。使用wx.navigateBack 可以返回到原页面。小程序中页面栈最多十层。

# <navigator url="">标签的 url 属性实现跳转页面
<view class="btn-area">
  <navigator url="/page/navigate/navigate?title=navigate" hover-class="navigator-hover">跳转到新页面</navigator>
</view>
```

**选择当前位置**


```js
# 选择位置  wx.chooseLocation
wx.chooseLocation({
    success: function(res){
        console.log(res)  // 打印地址    通过setData修改值
        
    }
})
```

**浮在原生组件的文本视图**


```js
#cover-view  控件   覆盖在原生组件之上的文本视图。（如： 返回当前定位）

可覆盖的原生组件包括 map、video、canvas、camera、live-player、live-pusher

只支持嵌套 cover-view、cover-image，可在 cover-view 中使用 button。组件属性的长度单位默认为px，2.4.0起支持传入单位(rpx/px)。

<cover-view class="play" bindtap="play">
      <cover-image class="img" src="/path/to/icon_play" />
</cover-view>
```

**点击回到当前的屏幕中心**


```js
# wx.createMapContext(string mapId, Object this)
# 创建 map 上下文 MapContext 对象。
# 地图返回到中心

onLoad() {
 // 创建 mapContext
 this.mapContext = wx.createMapContext('mymap', this)
},
// 回到中心点
backToCenter() {
  this.mapContext.moveToLocation()
},
```

**点击marker触发**

```js
# bindmarkertap 点击marker触发，返回marker的ID(markerID)

```

**点击控件时触发**

```js
# bindcontroltap   点击控件时触发，会返回control的id

```



**radio-group**

```js
# checkbox-group中选中项发生改变时触发 change 事件，
detail = {value:[选中的checkbox的value的数组]}

```

**input**

```js
# bindinput 事件
键盘输入时触发，event.detail = {value, cursor, keyCode}，keyCode 为键值，处理函数可以直接 return 一个字符串，将替换输入框的内容。
```

**微信提示框**

```js
wx.showToast({
        title: "请填写说明要求",
        icon: "none",	  // success、loading、none
        duration: 2000    // 提示的事件延迟
      })
```



****

